<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, shrink-to-fit=no" name="viewport">
  <title>{% block title %}App Monitor Dashboard{% endblock %}</title>
  <!-- General CSS Files -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/app.min.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='bundles/bootstrap-social/bootstrap-social.css') }}">
  <!-- Template CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
  <link rel="stylesheet" href="{{ url_for('static', filename='css/components.css') }}">
  <!-- Custom style CSS -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/custom.css') }}">
  <link rel='shortcut icon' type='image/svg+xml' href='{{ url_for("static", filename="img/favicon.svg") }}' />
  {% block extra_css %}{% endblock %}
</head>

<body>
  <div class="loader"></div>
  <div id="app">
    <div class="main-wrapper main-wrapper-1">
      <!-- Sidebar -->
      {% if current_user.is_authenticated %}
      <div class="navbar-bg"></div>
      <nav class="navbar navbar-expand-lg main-navbar">
        <a href="{{ url_for('main.dashboard') }}" class="navbar-brand">
          <img src="{{ url_for('static', filename='img/logo.svg') }}" alt="App Monitor" height="40" class="d-inline-block align-top">
        </a>
        <a href="#" class="nav-link sidebar-gone-show" data-toggle="sidebar">
          <i class="fas fa-bars"></i>
        </a>
        <div class="navbar-nav navbar-right ml-auto">
          <div class="dropdown">
            <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
              <i class="fas fa-user-circle mr-1"></i>
              {{ current_user.get_full_name() }}
            </a>
            <div class="dropdown-menu dropdown-menu-right">
              <a href="{{ url_for('main.profile') }}" class="dropdown-item">
                <i class="fas fa-user mr-2"></i> Profile
              </a>
              <div class="dropdown-divider"></div>
              <a href="{{ url_for('auth.logout') }}" class="dropdown-item">
                <i class="fas fa-sign-out-alt mr-2"></i> Logout
              </a>
            </div>
          </div>
        </div>
      </nav>

      <div class="main-sidebar sidebar-style-2">
        <aside id="sidebar-wrapper">
          <div class="sidebar-brand">
            <a href="{{ url_for('main.dashboard') }}">
              <img src="{{ url_for('static', filename='img/logo.svg') }}" alt="App Monitor" height="35" class="d-inline-block align-top">
            </a>
          </div>
          <div class="sidebar-brand sidebar-brand-sm">
            <a href="{{ url_for('main.dashboard') }}">
              <img src="{{ url_for('static', filename='img/logo-icon.svg') }}" alt="App Monitor" height="30" class="d-inline-block align-top">
            </a>
          </div>
          <ul class="sidebar-menu">
            <li class="menu-header">Navigation</li>
            <li class="{% if request.endpoint == 'main.dashboard' %}active{% endif %}">
              <a class="nav-link" href="{{ url_for('main.dashboard') }}">
                <i class="fas fa-tachometer-alt"></i> <span>Dashboard</span>
              </a>
            </li>
            <li class="{% if request.endpoint == 'company.company_dashboard' %}active{% endif %}">
              <a class="nav-link" href="{{ url_for('company.company_dashboard') }}">
                <i class="fas fa-building"></i> <span>Company</span>
              </a>
            </li>
            <li class="{% if request.endpoint == 'company.entra_setup' %}active{% endif %}">
              <a class="nav-link" href="{{ url_for('company.entra_setup') }}">
                <i class="fas fa-cog"></i> <span>Entra Setup</span>
              </a>
            </li>
            <li class="{% if request.endpoint == 'company.company_users' %}active{% endif %}">
              <a class="nav-link" href="{{ url_for('company.company_users') }}">
                <i class="fas fa-users"></i> <span>Users</span>
              </a>
            </li>
            <li class="{% if request.endpoint == 'api.metrics' %}active{% endif %}">
              <a class="nav-link" href="{{ url_for('api.metrics') }}">
                <i class="fas fa-chart-line"></i> <span>Metrics</span>
              </a>
            </li>
            <li class="{% if request.endpoint == 'main.profile' %}active{% endif %}">
              <a class="nav-link" href="{{ url_for('main.profile') }}">
                <i class="fas fa-user"></i> <span>Profile</span>
              </a>
            </li>
          </ul>
        </aside>
      </div>
      {% endif %}

      <!-- Main Content -->
      <div class="main-content">
        {% if current_user.is_authenticated %}
        <section class="section">
          <div class="section-header">
            <h1>{% block page_title %}{% endblock %}</h1>
          </div>
          {% endif %}
          
          <!-- Flash Messages -->
          {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
              <div class="container-fluid">
                {% for category, message in messages %}
                  <div class="alert alert-{{ 'danger' if category == 'error' else 'success' if category == 'success' else 'info' }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                {% endfor %}
              </div>
            {% endif %}
          {% endwith %}
          
          {% block content %}{% endblock %}
          
          {% if current_user.is_authenticated %}
        </section>
        {% endif %}
      </div>
      
      {% if current_user.is_authenticated %}
      <!-- Footer -->
      <footer class="main-footer">
        <div class="footer-left">
          Copyright &copy; 2025 <div class="bullet"></div> App Monitor Dashboard
        </div>
        <div class="footer-right">
          v1.0.0
        </div>
      </footer>
      {% endif %}
    </div>
  </div>
  
  <!-- General JS Scripts -->
  <script src="{{ url_for('static', filename='js/app.min.js') }}"></script>
  <!-- JS Libraries -->
  {% block extra_js %}{% endblock %}
  <!-- Template JS File -->
  <script src="{{ url_for('static', filename='js/scripts.js') }}"></script>
  <!-- Custom JS File -->
  <script src="{{ url_for('static', filename='js/custom.js') }}"></script>
</body>
</html>
